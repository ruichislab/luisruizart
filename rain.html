<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DIGITAL RAIN | Net Art</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body { background: #000; overflow: hidden; }
        canvas { display: block; }
    </style>
</head>
<body>
    <canvas id="rain"></canvas>
    <script type="module" src="js/menu.js"></script>
    <script src="js/touch-adapter.js"></script>
    <script>
        const canvas = document.getElementById('rain');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const columns = Math.floor(canvas.width / 20);
        const drops = [];
        const chars = '日ﾊﾐﾋｰｳｼﾅﾓﾆｻﾜﾂｵﾘｱﾎﾃﾏｹﾒｴｶｷﾑﾕﾗｾﾈｽﾀﾇﾍ0123456789:・."=*+-<>¦｜';

        for (let i = 0; i < columns; i++) {
            drops[i] = {
                y: Math.random() * canvas.height,
                speed: Math.random() * 5 + 2,
                text: '',
                color: '#0F0' // Default matrix green
            };
        }

        // Mouse interaction
        let mouse = { x: -100, y: -100 };
        document.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
        });

        function draw() {
            // Semi-transparent black to create trail effect
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Responsive font size
            const fontSize = Math.max(12, Math.min(20, canvas.width / 30));
            ctx.font = fontSize + 'px monospace';

            for (let i = 0; i < drops.length; i++) {
                const drop = drops[i];

                // Generate random character
                const char = chars[Math.floor(Math.random() * chars.length)];

                // Interaction: If near mouse, change color and char
                const x = i * 20;
                const dist = Math.abs(mouse.x - x);
                const distY = Math.abs(mouse.y - drop.y);

                if (dist < 100 && distY < 100) {
                    ctx.fillStyle = '#FFF'; // White hot
                    drop.speed = 0; // Freeze time locally
                    if(Math.random() > 0.9) drop.speed = 10; // Glitch speed
                } else {
                    ctx.fillStyle = '#0F0';
                    if (Math.random() > 0.98) ctx.fillStyle = '#00FF88'; // Varied green
                }

                ctx.fillText(char, x, drop.y);

                // Move drop
                drop.y += drop.speed;

                // Reset to top randomly
                if (drop.y > canvas.height && Math.random() > 0.975) {
                    drop.y = 0;
                    drop.speed = Math.random() * 5 + 2;
                }
            }
            requestAnimationFrame(draw);
        }
        draw();

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
